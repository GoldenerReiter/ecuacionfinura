<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Gaucho Bot√°nico | La M√°quina del Tropero</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #F9F8F6;
            --text-main: #2C352D;
            --text-muted: #5A665A;
            --accent-gold: #C2A878;
            --accent-green: #1E2B22;
            --nav-bg: rgba(255, 255, 255, 0.95);
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.6' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
            -webkit-tap-highlight-color: transparent;
        }

        h1, h2, h3, .serif-font {
            font-family: 'Cormorant Garamond', serif;
        }

        /* App Container */
        .app-container {
            display: grid;
            grid-template-columns: 1fr;
            grid-template-rows: 1fr;
            width: 100%;
            max-width: 800px;
            flex-grow: 1;
            margin: 0 auto;
            align-items: stretch;
            min-height: 0;
            position: relative;
        }

        /* Vistas (Tabs) */
        .tab-view {
            grid-column: 1;
            grid-row: 1;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 2rem;
            opacity: 0;
            visibility: hidden;
            transform: scale(0.98);
            transition: opacity 0.3s ease, transform 0.4s cubic-bezier(0.1, 0.9, 0.2, 1), visibility 0.4s;
            pointer-events: none;
            z-index: 1;
        }

        .tab-view::-webkit-scrollbar { width: 4px; }
        .tab-view::-webkit-scrollbar-track { background: transparent; }
        .tab-view::-webkit-scrollbar-thumb { background-color: rgba(194, 168, 120, 0.4); border-radius: 10px; }

        .tab-view.active {
            opacity: 1;
            visibility: visible;
            transform: scale(1);
            pointer-events: auto;
            z-index: 2;
        }

        /* Direcciones de animaci√≥n Swipe */
        .tab-view.from-left { transform: translateX(-30px); }
        .tab-view.from-right { transform: translateX(30px); }

        /* UI Elements */
        .card-elegant {
            background: white;
            border: 1px solid rgba(194, 168, 120, 0.3);
            box-shadow: 0 4px 20px -5px rgba(0,0,0,0.05);
        }

        /* Calculadora App Styles */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }
        
        .calc-profile-btn {
            border: 1px solid rgba(194, 168, 120, 0.3);
            color: var(--text-muted);
            transition: all 0.2s ease;
            background: #F9F8F6;
        }
        .calc-profile-btn.active {
            background-color: var(--accent-green);
            color: var(--accent-gold);
            border-color: var(--accent-green);
            box-shadow: 0 4px 10px rgba(30, 43, 34, 0.15);
        }
        .qty-btn {
            background: #F9F8F6;
            color: var(--accent-green);
            border: 1px solid rgba(194, 168, 120, 0.4);
            transition: all 0.2s;
            touch-action: manipulation;
        }
        .qty-btn:active {
            background: var(--accent-gold);
            color: white;
            border-color: var(--accent-gold);
        }

        /* Bottom Nav */
        .bottom-nav {
            background: var(--nav-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-top: 1px solid rgba(194, 168, 120, 0.2);
            padding-bottom: env(safe-area-inset-bottom); /* Para iPhone Notch */
        }
        
        .nav-item {
            color: var(--text-muted);
            transition: all 0.2s ease;
        }
        .nav-item.active {
            color: var(--accent-green);
        }
        .nav-item.active .icon-bg {
            background-color: var(--accent-gold);
            color: white;
            transform: translateY(-2px);
        }
        .nav-item .icon-bg {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Dynamic Highlighting en Preparaci√≥n */
        .dyn-val {
            color: var(--accent-green);
            font-weight: 700;
            background: rgba(194, 168, 120, 0.15);
            padding: 0 4px;
            border-radius: 4px;
            border-bottom: 2px solid var(--accent-gold);
        }
    </style>
</head>
<body class="h-[100dvh] w-screen overflow-hidden flex flex-col">

    <!-- Header Fijo -->
    <header class="w-full flex justify-center shrink-0 pt-4 pb-3 px-4 bg-gradient-to-b from-[#F9F8F6] to-transparent z-10">
        <h1 class="serif-font text-2xl md:text-3xl font-bold tracking-wide text-[#1E2B22]">
            <span class="text-[#C2A878] italic mr-1">La M√°quina</span>del Tropero
        </h1>
    </header>

    <!-- √ÅREA PRINCIPAL (Tabs Scrolleables) -->
    <main class="app-container px-3 sm:px-6" id="swipe-zone">
        
        <!-- VISTA 1: LA CALCULADORA (Vista Central y Principal) -->
        <section class="tab-view active pt-2" id="view-0">
            <div class="text-center mb-4 md:mb-6">
                <p class="text-sm text-[#5A665A] font-light max-w-md mx-auto">Seleccione su viaje deseado y ajuste los gramos. La m√°quina dictar√° su receta perfecta.</p>
            </div>

            <div class="card-elegant rounded-xl relative shadow-lg bg-white p-3 sm:p-8 w-full">
                
                <h4 class="text-[10px] md:text-xs font-semibold uppercase tracking-widest text-[#C2A878] mb-3 ml-1">1. Seleccione el Perfil</h4>
                
                <!-- Grid modificado a 5 columnas para alojar el perfil personalizado -->
                <div class="grid grid-cols-5 gap-1.5 md:gap-2 mb-6">
                    <button class="calc-profile-btn active py-2 sm:py-3 px-0.5 rounded-lg text-[9px] sm:text-xs font-medium flex flex-col items-center justify-center gap-1.5" data-profile="alba">
                        <span class="text-lg md:text-xl">‚òÄÔ∏è</span> <span class="leading-tight">Mate<br>Alba</span>
                    </button>
                    <button class="calc-profile-btn py-2 sm:py-3 px-0.5 rounded-lg text-[9px] sm:text-xs font-medium flex flex-col items-center justify-center gap-1.5" data-profile="alivio">
                        <span class="text-lg md:text-xl">üåø</span> <span class="leading-tight">Alivio<br>F√≠sico</span>
                    </button>
                    <button class="calc-profile-btn py-2 sm:py-3 px-0.5 rounded-lg text-[9px] sm:text-xs font-medium flex flex-col items-center justify-center gap-1.5" data-profile="fogon">
                        <span class="text-lg md:text-xl">üî•</span> <span class="leading-tight">Rueda<br>Fog√≥n</span>
                    </button>
                    <button class="calc-profile-btn py-2 sm:py-3 px-0.5 rounded-lg text-[9px] sm:text-xs font-medium flex flex-col items-center justify-center gap-1.5" data-profile="mansa">
                        <span class="text-lg md:text-xl">üåô</span> <span class="leading-tight">Noche<br>Mansa</span>
                    </button>
                    <button class="calc-profile-btn py-2 sm:py-3 px-0.5 rounded-lg text-[9px] sm:text-xs font-medium flex flex-col items-center justify-center gap-1.5" data-profile="custom">
                        <span class="text-lg md:text-xl">‚öñÔ∏è</span> <span class="leading-tight">A Ojo<br>(Libre)</span>
                    </button>
                </div>

                <hr class="border-t border-[#EAE5D9] mb-6">

                <!-- Inputs Materia Prima -->
                <h4 class="text-[10px] md:text-xs font-semibold uppercase tracking-widest text-[#C2A878] mb-3 ml-1">2. Ajuste la Materia</h4>
                <div class="flex flex-col gap-4 mb-6">
                    <div class="flex items-center justify-between bg-[#F9F8F6] p-3 rounded-lg border border-[#EAE5D9]">
                        <div>
                            <span class="block text-sm font-semibold text-[#1E2B22]">Flor Sativa de Club</span>
                            <span class="text-[10px] text-[#5A665A]">Aporta THC y terpenos</span>
                        </div>
                        <div class="flex items-center shrink-0">
                            <button class="qty-btn w-9 h-10 md:w-10 flex items-center justify-center font-bold rounded-l-md text-lg" data-target="calc-flor" data-action="minus">‚àí</button>
                            <input type="number" id="calc-flor" class="w-12 md:w-14 h-10 text-center font-bold text-lg border-y border-[#C2A878]/40 outline-none bg-white text-[#1E2B22]" value="10" min="0">
                            <button class="qty-btn w-9 h-10 md:w-10 flex items-center justify-center font-bold rounded-r-md text-lg" data-target="calc-flor" data-action="plus">+</button>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between bg-[#F9F8F6] p-3 rounded-lg border border-[#EAE5D9]">
                        <div>
                            <span class="block text-sm font-semibold text-[#1E2B22]">Flor Vapeada (AVB)</span>
                            <span class="text-[10px] text-[#8B5A2B]">Efecto corporal (Opcional)</span>
                        </div>
                        <div class="flex items-center shrink-0">
                            <button class="qty-btn w-9 h-10 md:w-10 flex items-center justify-center font-bold rounded-l-md text-lg" data-target="calc-avb" data-action="minus">‚àí</button>
                            <input type="number" id="calc-avb" class="w-12 md:w-14 h-10 text-center font-bold text-lg border-y border-[#C2A878]/40 outline-none bg-white text-[#5A665A]" value="0" min="0">
                            <button class="qty-btn w-9 h-10 md:w-10 flex items-center justify-center font-bold rounded-r-md text-lg" data-target="calc-avb" data-action="plus">+</button>
                        </div>
                    </div>
                </div>

                <!-- Panel de Resultados Base -->
                <div class="bg-[#1E2B22] rounded-xl p-5 shadow-inner text-white relative overflow-hidden">
                    <div class="absolute -right-4 -top-4 opacity-10 text-7xl">üßÆ</div>
                    <h4 class="text-[10px] font-semibold uppercase tracking-widest text-[#C2A878] mb-4">Resultados de la Mezcla</h4>
                    
                    <div class="grid grid-cols-2 gap-y-5 gap-x-2 relative z-10">
                        <div>
                            <span class="block text-[10px] text-white/60 mb-0.5">Ghee a Usar (Crudo)</span>
                            <span class="text-2xl font-bold text-white"><span id="res-ghee">150</span> <span class="text-sm font-normal">g</span></span>
                        </div>
                        <div>
                            <span class="block text-[10px] text-white/60 mb-0.5">Oro Verde (Final Colado)</span>
                            <span class="text-2xl font-bold text-[#C2A878]"><span id="res-yield">129</span> <span class="text-sm font-normal">g</span></span>
                        </div>
                        <div class="col-span-2 bg-black/20 p-3 rounded-lg border-l-2 border-[#C2A878] flex justify-between items-center">
                            <div class="pr-2">
                                <span class="block text-[9px] text-white/50 uppercase tracking-widest mb-0.5">Efecto & Dosis Estimada</span>
                                <span class="text-[11px] sm:text-sm font-medium text-[#C2A878] leading-tight block" id="res-dose">1 Cuadro (Foco y Claridad)</span>
                            </div>
                            <div class="text-right pl-2 border-l border-white/10 shrink-0">
                                <span class="block text-[9px] text-white/50 uppercase tracking-widest mb-0.5">Cortes</span>
                                <span class="text-xl font-bold text-white"><span id="res-cuadros">40</span> <span class="text-xs font-normal">u</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Call to action interno -->
                <button onclick="switchTab(1)" class="w-full mt-4 bg-[#C2A878] text-[#1E2B22] font-bold py-3 rounded-lg shadow-md flex items-center justify-center gap-2 hover:bg-[#b09765] transition-colors text-sm">
                    Ver Instrucciones de Preparaci√≥n <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                </button>

            </div>
        </section>

        <!-- VISTA 2: PREPARACI√ìN DIN√ÅMICA -->
        <section class="tab-view pt-2" id="view-1">
            <div class="text-center mb-6">
                <h2 class="serif-font text-3xl text-[#1E2B22] mb-1">Tu Receta Espec√≠fica</h2>
                <p class="text-xs text-[#C2A878] uppercase tracking-widest">Basada en La M√°quina</p>
            </div>

            <div class="space-y-4">
                
                <!-- PASO 1: Descarboxilaci√≥n -->
                <div class="card-elegant p-5 rounded-xl">
                    <div class="flex items-center gap-3 mb-3 border-b border-[#EAE5D9] pb-3">
                        <div class="w-8 h-8 rounded-full bg-[#1E2B22] text-[#C2A878] flex items-center justify-center font-bold font-serif">1</div>
                        <h3 class="serif-font text-2xl text-[#1E2B22] leading-none">El Horno Manso</h3>
                    </div>
                    
                    <p class="text-sm text-[#5A665A] leading-relaxed">
                        Toma tus <span class="dyn-val" id="dyn-flor">10</span> <strong class="text-[#1E2B22]">gramos de Flor Sativa</strong> y p√≠calos levemente (no polvo). Col√≥calos en una asadera y t√°pala herm√©ticamente con papel aluminio para cuidar los terpenos.
                    </p>
                    <div class="mt-3 bg-[#F9F8F6] p-3 rounded text-sm border border-[#EAE5D9]">
                        Lleva la asadera al horno a <span class="dyn-val" id="dyn-temp">110¬∞C</span> durante <strong>40 minutos</strong>. 
                        <span class="block text-[10px] text-red-800 mt-1 italic">*Atenci√≥n: No superes los 160¬∞C en ning√∫n momento.</span>
                    </div>
                </div>

                <!-- PASO 2: Infusi√≥n -->
                <div class="card-elegant p-5 rounded-xl">
                    <div class="flex items-center gap-3 mb-3 border-b border-[#EAE5D9] pb-3">
                        <div class="w-8 h-8 rounded-full bg-[#1E2B22] text-[#C2A878] flex items-center justify-center font-bold font-serif">2</div>
                        <h3 class="serif-font text-2xl text-[#1E2B22] leading-none">El Ba√±o de Oro</h3>
                    </div>
                    
                    <p class="text-sm text-[#5A665A] leading-relaxed mb-3">
                        En un frasco de vidrio grueso (o a ba√±o mar√≠a directo), coloca los <span class="dyn-val" id="dyn-ghee">150</span> <strong class="text-[#1E2B22]">gramos de Ghee crudo</strong>. 
                        <br><br>
                        Agrega la flor reci√©n salida del horno <span id="dyn-avb-section" class="hidden">y s√∫male los <span class="dyn-val bg-[#EAE5D9] text-[#8B5A2B] border-[#8B5A2B]" id="dyn-avb">0</span> <strong class="text-[#8B5A2B]">gramos de AVB</strong> directamente</span>.
                    </p>
                    <ul class="text-sm text-[#5A665A] space-y-2 mt-2 list-disc pl-4">
                        <li><strong>Temperatura:</strong> Mant√©n el agua entre 75¬∞C y 85¬∞C (que tire humo pero no hierva a borbotones).</li>
                        <li><strong>Tiempo:</strong> Deja infusionar de 3 a 4 horas, revolviendo suavemente cada media hora.</li>
                        <li><strong>Colado:</strong> Pasa la mezcla caliente por una gasa doble. <strong>¬°No exprimas la materia vegetal!</strong> Deja que escurra solo para evitar amargor.</li>
                    </ul>
                    <div class="mt-3 text-sm text-[#1E2B22] font-semibold bg-green-50 p-2 rounded text-center border border-green-200">
                        Deber√≠as obtener aprox. <span class="dyn-val" id="dyn-yield">129</span> gramos de Oro Verde neto.
                    </div>
                </div>

                <!-- PASO 3: Asadera Final -->
                <div class="card-elegant p-5 rounded-xl">
                    <div class="flex items-center gap-3 mb-3 border-b border-[#EAE5D9] pb-3">
                        <div class="w-8 h-8 rounded-full bg-[#1E2B22] text-[#C2A878] flex items-center justify-center font-bold font-serif">3</div>
                        <h3 class="serif-font text-2xl text-[#1E2B22] leading-none">Armado y Dosis</h3>
                    </div>
                    
                    <p class="text-sm text-[#5A665A] leading-relaxed mb-3">
                        Prepara la mezcla de brownies (o receta elegida) utilizando tus <span class="dyn-val" id="dyn-yield2">129</span> <strong class="text-[#1E2B22]">gramos de Ghee Verde</strong>. 
                        Hornea tu preparaci√≥n <strong class="text-red-900">a no m√°s de 160¬∞C</strong>.
                    </p>
                    
                    <div class="bg-[#1E2B22] text-white p-4 rounded-lg mt-2 relative overflow-hidden">
                        <div class="absolute right-0 bottom-0 opacity-10">
                            <svg width="60" height="60" viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h16v16H4V4zm2 2v12h12V6H6zm2 2h3v3H8V8zm5 0h3v3h-3V8zm-5 5h3v3H8v-3zm5 0h3v3h-3v-3z"/></svg>
                        </div>
                        <p class="text-xs uppercase tracking-widest text-[#C2A878] mb-2 relative z-10">La Matem√°tica del Corte</p>
                        <p class="text-sm mb-2 relative z-10">Para mantener la dosis que elegiste en la m√°quina, usa un molde cuadrado y, una vez fr√≠o, c√≥rtalo en exactamente:</p>
                        <p class="text-3xl font-serif text-[#C2A878] relative z-10"><span id="dyn-cuadros">40</span> <span class="text-lg font-sans text-white/80">porciones id√©nticas.</span></p>
                    </div>
                </div>

            </div>
        </section>

        <!-- VISTA 3: LA ESCALA -->
        <section class="tab-view pt-2" id="view-2">
            <div class="text-center mb-6">
                <h2 class="serif-font text-3xl text-[#1E2B22] mb-1">La Escala</h2>
                <p class="text-[10px] md:text-xs text-[#C2A878] uppercase tracking-widest">Referencias universales de la app</p>
            </div>

            <div class="card-elegant p-2 rounded-xl mb-6">
                <div class="p-3 bg-[#F9F8F6] rounded-lg mb-2 border border-[#EAE5D9]">
                    <p class="text-[11px] md:text-xs text-[#5A665A] text-center italic">Los perfiles predeterminados est√°n calculados en base a la recuperaci√≥n de <strong class="text-[#1E2B22]">150g de Ghee crudo</strong>.</p>
                </div>
                <div class="overflow-x-auto w-full pb-2">
                    <table class="elegant-table min-w-[500px]">
                        <thead>
                            <tr>
                                <th class="w-1/3">Perfil / Prop√≥sito</th>
                                <th>Flor Sativa</th>
                                <th>Flor AVB</th>
                                <th>Horno</th>
                                <th>Dosis (De 40)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <strong class="text-[#1E2B22] text-sm md:text-base">Mate del Alba</strong><br>
                                    <span class="text-[9px] text-[#C2A878] uppercase tracking-wider">Focus y Trabajo</span>
                                </td>
                                <td class="font-medium text-[#2C352D]">10 g</td>
                                <td class="text-gray-400">0 g</td>
                                <td>110¬∞C</td>
                                <td><span class="bg-[#F9F8F6] px-2 py-1 rounded border border-[#EAE5D9] text-xs font-semibold">1 Cuadro</span></td>
                            </tr>
                            <tr>
                                <td>
                                    <strong class="text-[#1E2B22] text-sm md:text-base">Alivio F√≠sico</strong><br>
                                    <span class="text-[9px] text-[#C2A878] uppercase tracking-wider">Dolores y Calma</span>
                                </td>
                                <td class="font-medium text-[#2C352D]">12 g</td>
                                <td class="text-gray-400">0 g</td>
                                <td>115¬∞C</td>
                                <td><span class="bg-[#F9F8F6] px-2 py-1 rounded border border-[#EAE5D9] text-xs font-semibold">1 Cuadro</span></td>
                            </tr>
                            <tr>
                                <td>
                                    <strong class="text-[#1E2B22] text-sm md:text-base">Rueda de Fog√≥n</strong><br>
                                    <span class="text-[9px] text-[#C2A878] uppercase tracking-wider">Charla y Asado</span>
                                </td>
                                <td class="font-medium text-[#2C352D]">10 g</td>
                                <td class="text-[#8B5A2B] font-medium">2 g</td>
                                <td>110¬∞C</td>
                                <td><span class="bg-[#EAE5D9] px-2 py-1 rounded text-[#1E2B22] font-semibold text-xs">2 Cuadros</span></td>
                            </tr>
                            <tr class="bg-[#FAF8F5]">
                                <td>
                                    <strong class="text-[#8B5A2B] text-sm md:text-base">Noche Mansa</strong><br>
                                    <span class="text-[9px] text-[#C2A878] uppercase tracking-wider">Receta Nocturna</span>
                                </td>
                                <td class="font-medium text-[#2C352D]">5 g</td>
                                <td><strong class="text-[#8B5A2B]">8 g</strong></td>
                                <td>118¬∞C</td>
                                <td><span class="bg-[#EAE5D9] px-2 py-1 rounded text-[#1E2B22] font-semibold text-xs">2 Cuadros</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Explicaci√≥n Cient√≠fica Breve -->
            <div class="px-2">
                <h4 class="serif-font text-xl text-[#1E2B22] mb-2 border-b border-[#EAE5D9] pb-1">Ciencia de Absorci√≥n</h4>
                <p class="text-xs text-[#5A665A] mb-2 text-justify">La m√°quina calcula el Ghee necesario bas√°ndose en la tasa √≥ptima de solubilidad lip√≠dica. 1 gramo de flor fresca satura aproximadamente 15g de l√≠pidos, mientras que el AVB (m√°s seco) absorbe menos Ghee pero rinde diferente.</p>
                <p class="text-xs text-[#5A665A] text-justify">Siempre se asume una <strong>p√©rdida de filtrado del ~14%</strong> (merma en la gasa). Los cortes se ajustan din√°micamente para que un "cuadrito" siempre represente la misma cantidad real de mg de THC.</p>
            </div>
        </section>

        <!-- VISTA 4: EL LORE (ALMANAQUE) -->
        <section class="tab-view pt-2" id="view-3">
            <div class="text-center mb-6">
                <h2 class="serif-font text-3xl text-[#1E2B22] mb-1">El Almanaque</h2>
                <p class="text-[10px] md:text-xs text-[#C2A878] uppercase tracking-widest">Sabidur√≠a Oriental</p>
            </div>

            <div class="card-elegant p-6 sm:p-10 rounded-xl mb-4 text-center relative overflow-hidden">
                <div class="absolute inset-0 opacity-5 pointer-events-none" style="background-image: url('https://images.unsplash.com/photo-1528698827591-e19ccd7bc23d?auto=format&fit=crop&q=80'); background-size: cover; background-position: center;"></div>
                
                <h3 class="serif-font text-3xl text-[#1E2B22] mb-6 relative z-10">D√©cimas del Bot√°nico</h3>
                
                <div class="text-[#5A665A] text-[15px] leading-relaxed font-light space-y-5 italic relative z-10">
                    <p>
                        Asiente el mate, mi amigo, y escuche con atenci√≥n,<br>
                        que pa‚Äô lograr la "finura" no basta con la intenci√≥n.<br>
                        Si la Sativa es de club, y el Ghee pide su destino,<br>
                        oiga bien estas palabras... que le marcan el camino.
                    </p>
                    <p>
                        Ciento quince los graditos, ni uno m√°s pa' no quemar,<br>
                        que si el Limoneno vuela... no lo vuelve a recuperar.<br>
                        Coma un solo cuadradito, y espere que el sol se ponga,<br>
                        que este Ghee no perdona... ¬°si usted me la rezonga!
                    </p>
                </div>
            </div>

            <div class="text-center mt-8 pb-4 opacity-50">
                <p class="text-[10px] uppercase tracking-widest">MVD ‚Ä¢ URUGUAY ‚Ä¢ 2026</p>
            </div>
        </section>

    </main>

    <!-- BOTTOM NAVIGATION (App Style) -->
    <nav class="bottom-nav w-full shrink-0 flex justify-around items-center px-2 py-2 pb-4 z-20">
        <button class="nav-item active flex flex-col items-center gap-1 w-1/4 pt-1" data-target="0">
            <div class="icon-bg w-10 h-8 rounded-full flex items-center justify-center text-xl bg-[#C2A878] text-white">üßÆ</div>
            <span class="text-[10px] font-semibold tracking-wide">M√°quina</span>
        </button>
        <button class="nav-item flex flex-col items-center gap-1 w-1/4 pt-1" data-target="1">
            <div class="icon-bg w-10 h-8 rounded-full flex items-center justify-center text-xl text-[#5A665A]">üç≥</div>
            <span class="text-[10px] font-semibold tracking-wide">Receta</span>
        </button>
        <button class="nav-item flex flex-col items-center gap-1 w-1/4 pt-1" data-target="2">
            <div class="icon-bg w-10 h-8 rounded-full flex items-center justify-center text-xl text-[#5A665A]">üß≠</div>
            <span class="text-[10px] font-semibold tracking-wide">Escala</span>
        </button>
        <button class="nav-item flex flex-col items-center gap-1 w-1/4 pt-1" data-target="3">
            <div class="icon-bg w-10 h-8 rounded-full flex items-center justify-center text-xl text-[#5A665A]">üìú</div>
            <span class="text-[10px] font-semibold tracking-wide">Lore</span>
        </button>
    </nav>

    <script>
        /* -----------------------------------------------------------------
           L√ìGICA DE NAVEGACI√ìN (TABS Y SWIPE)
        ----------------------------------------------------------------- */
        const views = document.querySelectorAll('.tab-view');
        const navItems = document.querySelectorAll('.nav-item');
        let currentTab = 0;
        const totalTabs = views.length;
        let isAnimating = false;

        function switchTab(targetIndex) {
            if (isAnimating || targetIndex === currentTab) return;
            isAnimating = true;
            
            let direction = targetIndex > currentTab ? 'next' : 'prev';
            let oldTab = currentTab;
            currentTab = targetIndex;

            // Actualizar botones de navegaci√≥n inferor
            navItems.forEach((btn, idx) => {
                if (idx === currentTab) {
                    btn.classList.add('active');
                    btn.querySelector('.icon-bg').classList.replace('text-[#5A665A]', 'text-white');
                    btn.querySelector('.icon-bg').classList.add('bg-[#C2A878]');
                } else {
                    btn.classList.remove('active');
                    btn.querySelector('.icon-bg').classList.replace('text-white', 'text-[#5A665A]');
                    btn.querySelector('.icon-bg').classList.remove('bg-[#C2A878]');
                }
            });

            // Animar Vistas
            views.forEach((view, index) => {
                view.classList.remove('active', 'from-left', 'from-right');
                
                if (index === currentTab) {
                    view.scrollTop = 0; // Reset scroll al entrar a la tab
                    if (direction === 'next') {
                        view.classList.add('from-right');
                        void view.offsetWidth; 
                        view.classList.remove('from-right');
                    } else {
                        view.classList.add('from-left');
                        void view.offsetWidth; 
                        view.classList.remove('from-left');
                    }
                    view.classList.add('active');
                }
            });

            setTimeout(() => { isAnimating = false; }, 400);
        }

        navItems.forEach((btn) => {
            btn.addEventListener('click', () => {
                switchTab(parseInt(btn.dataset.target));
            });
        });

        // L√≥gica de Swipe
        let touchStartX = 0;
        let touchStartY = 0;
        const swipeZone = document.getElementById('swipe-zone');
        let blockSwipe = false;

        swipeZone.addEventListener('touchstart', e => {
            if (e.target.tagName.toLowerCase() === 'input' || e.target.tagName.toLowerCase() === 'button') {
                blockSwipe = true;
                return;
            }
            const scrollableParent = e.target.closest('.overflow-x-auto');
            if (scrollableParent && scrollableParent.scrollWidth > scrollableParent.clientWidth) {
                blockSwipe = true;
                return;
            }
            blockSwipe = false;
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }, {passive: true});

        swipeZone.addEventListener('touchend', e => {
            if (blockSwipe) return;
            
            let touchEndX = e.changedTouches[0].screenX;
            let touchEndY = e.changedTouches[0].screenY;
            
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;
            
            if (Math.abs(diffY) > Math.abs(diffX) || Math.abs(diffX) < 50) return;

            if (diffX > 0 && currentTab < totalTabs - 1) {
                switchTab(currentTab + 1); 
            } else if (diffX < 0 && currentTab > 0) {
                switchTab(currentTab - 1); 
            }
        }, {passive: true});


        /* -----------------------------------------------------------------
           L√ìGICA DE LA M√ÅQUINA (CALCULADORA & AUTO-PERFIL)
        ----------------------------------------------------------------- */
        // Definici√≥n estricta de las recetas base
        const profiles = {
            alba:   { flor: 10, avb: 0, temp: "110¬∞C", dose: "1 Cuadro (Foco y Claridad)" },
            alivio: { flor: 12, avb: 0, temp: "115¬∞C", dose: "1 Cuadro (Alivio F√≠sico)" },
            fogon:  { flor: 10, avb: 2, temp: "110¬∞C", dose: "2 Cuadros (Social / Charla)" },
            mansa:  { flor: 5,  avb: 8, temp: "118¬∞C", dose: "2 Cuadros (Relax Nocturno)" },
            custom: { flor: null, avb: null, temp: "115¬∞C", dose: "Receta Libre (Calculado a Ojo)" }
        };

        let activeProfile = 'alba';
        const inputFlor = document.getElementById('calc-flor');
        const inputAvb = document.getElementById('calc-avb');
        
        function updateCalculations(autoMatchProfile = true) {
            let flor = parseFloat(inputFlor.value);
            if(isNaN(flor) || flor < 0) { flor = 0; inputFlor.value = 0; }
            
            let avb = parseFloat(inputAvb.value);
            if(isNaN(avb) || avb < 0) { avb = 0; inputAvb.value = 0; }
            
            // INTELIGENCIA DE DETECCI√ìN DE PERFIL
            if (autoMatchProfile) {
                let matchedProfile = 'custom';
                for (const [key, profile] of Object.entries(profiles)) {
                    if (key !== 'custom' && profile.flor === flor && profile.avb === avb) {
                        matchedProfile = key;
                        break;
                    }
                }

                if (activeProfile !== matchedProfile) {
                    activeProfile = matchedProfile;
                    document.querySelectorAll('.calc-profile-btn').forEach(b => b.classList.remove('active'));
                    const activeBtn = document.querySelector(`.calc-profile-btn[data-profile="${activeProfile}"]`);
                    if(activeBtn) activeBtn.classList.add('active');
                }
            }

            // Matem√°tica del Gaucho
            const ghee = Math.round((flor * 15) + (avb * 9.375));
            const yieldGhee = Math.round(ghee * 0.86);
            const cuadros = Math.round((flor * 4) + (avb * 2.5));
            const temp = profiles[activeProfile].temp;
            
            // 1. Actualizar UI de La M√°quina
            document.getElementById('res-ghee').textContent = `${ghee}`;
            document.getElementById('res-yield').textContent = `${yieldGhee}`;
            document.getElementById('res-cuadros').textContent = cuadros > 0 ? `${cuadros}` : '0';
            document.getElementById('res-dose').textContent = profiles[activeProfile].dose;
            
            // 2. Actualizar UI de "Preparaci√≥n"
            document.getElementById('dyn-flor').textContent = flor;
            document.getElementById('dyn-temp').textContent = temp;
            document.getElementById('dyn-ghee').textContent = ghee;
            document.getElementById('dyn-yield').textContent = yieldGhee;
            document.getElementById('dyn-yield2').textContent = yieldGhee;
            document.getElementById('dyn-cuadros').textContent = cuadros > 0 ? `${cuadros}` : '0';
            
            // L√≥gica condicional para mostrar el paso del AVB en la receta
            const avbSection = document.getElementById('dyn-avb-section');
            if (avb > 0) {
                avbSection.classList.remove('hidden');
                document.getElementById('dyn-avb').textContent = avb;
            } else {
                avbSection.classList.add('hidden');
            }

            // Animaci√≥n de los valores din√°micos
            const dynVals = document.querySelectorAll('.dyn-val');
            dynVals.forEach(el => {
                el.style.backgroundColor = 'rgba(194, 168, 120, 0.4)';
                setTimeout(() => { el.style.backgroundColor = 'rgba(194, 168, 120, 0.15)'; }, 300);
            });
        }

        // Click en Perfiles
        document.querySelectorAll('.calc-profile-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.calc-profile-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                activeProfile = btn.dataset.profile;
                
                // Si eligen una receta predefinida, rellenamos los inputs correspondientes
                if (activeProfile !== 'custom') {
                    inputFlor.value = profiles[activeProfile].flor;
                    inputAvb.value = profiles[activeProfile].avb;
                }
                
                updateCalculations(false); // Falso = No intentar auto-detectar porque el usuario forz√≥ el bot√≥n
            });
        });

        // Cambios manuales en los inputs (Trigger del auto-match)
        inputFlor.addEventListener('input', () => updateCalculations(true));
        inputAvb.addEventListener('input', () => updateCalculations(true));

        // Botones de + y -
        document.querySelectorAll('.qty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const targetId = btn.dataset.target;
                const action = btn.dataset.action;
                const input = document.getElementById(targetId);
                let val = parseFloat(input.value) || 0;
                
                if (action === 'plus') val += 1;
                if (action === 'minus' && val > 0) val -= 1;
                
                input.value = val;
                updateCalculations(true); // Verdadero = Altera el input, as√≠ que auto-detectamos si coincide con una receta
            });
        });

        // Inicializaci√≥n
        updateCalculations(true);
    </script>
</body>
</html>